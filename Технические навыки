Тестовая задача T-SQL

Пропущенные интервалы натурального ряда - решение принимается в виде скрипта, содержащего Transact-SQL с запросом(-ами) для получения ожидаемой выборки.
В базе данных имеется таблица, хранящая натуральные числа без повторений. Необходимо вывести отсутствующие интервалы. 
Предполагается, что для решения задачи t-sql будет использован не как язык алгоритмов, а как Structured Query Language. Также ожидается, что решение не будет использовать курсоры.

declare @values as table
    (
        [number] int not null -- значение (уникальное значение в рамках таблицы)
    )

/* Тестовая ситуация */
insert into @values
(
    [number]
)
values
(1)
, (2)
, (3)
, (5)
, (9)

/* Ожидаемый результат */
/*
left    right
4    4
6    8
*/

Решение тестовой задачи TSQL *
Необходимо указать решение, либо указать смогли бы Вы ее решить ("решил бы" или "не решил бы"). В случае отсутствия решения в анкете, во время технического интервью будет необходимо рассказать решение или путь, которым Вы бы к нему пошли


Тестовая задача C#
Сумма без сдачи.
Иван Васильевич стоит у кассы продуктового магазина с покупками в корзине, продавщица на кассе просит дать ей сумму, необходимую для оплаты товаров, без сдачи.
В кармане Ивана Васильевича имеются купюры различного достоинства (достоинства купюр не привязываемся к реальным денежным знакам, единственное ограничение - номинал купюры целое число > 0) в случайном порядке.
Необходимо подобрать необходимую сумму без сдачи или указать, что это невозможно.
Решение принимается в виде одного файла с исходным кодом (Program.cs), написанного на языке c#.
В консольное приложение параметрами командной строки передаются полные пути к файлу с исходными данными последовательностей (1-ый параметр) и файлу результата (2-ой параметр).
В файле с исходными данными указаны последовательности целых положительных чисел, которые помещаются в тип int.
В каждой строке указана последовательность чисел, разделенных ";". Первое число указывает значение требуемой суммы, остальные - номиналы имеющихся купюр. Последовательность может заканчиваться как числом так и ";".
В файл результата выводятся номиналы купюры при помощи которых можно подобрать сумму без сдачи (это также должны быть числа, разделенные ";", указанные в любом порядке) или слово "NO", если подобрать сумму без сдачи нельзя.
В случае наличия нескольких вариантов для получения суммы без сдачи, в качестве ответа может быть указан любой.
Итоговое время, затраченное на получение решений для всех тестовых ситуаций, указанных в примере входных данных, не должно превышать 1 минуты.

Пример входных данных:
in.txt
100;100;
100;50;70;120;150
12;1;9;7;3;5;
30;1;2
30;60;15;9;9;9;8;8;5;5;3;3;3;3;3;2;2;2;1
2147483647;2147483500;100;40;5;1;1;1;1
100;100;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;
100;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;
50;49;47;30;15;10;10;
101;98;90;80;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;
101;98;90;80;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;1
50;49;47;32;30;15;15;12;11;10;9;
250;500;500;500;300;300;300;100;100;100;20;20;20;4;4;4;2;1;1
100001;2;4;6;8;10;12;14;16;18;20;22;24;26;28;30;32;34;36;38;40;42;44;46;48;50;52;54;56;58;60;62;64;66;68;70;72;74;76;78;80;82;84;86;88;90;92;94;96;98;100;102;104;106;108;110;112;114;
101;2;4;6;8;10;12;14;16;18;20;22;24;26;28;30;32;34;36;38;40;42;44;46;48;50;
200;3;6;9;12;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3;3
197;5;15;25;10;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;5;

Пример выходных данных:
out.txt
100
NO
5;7
NO
15;9;5;1
2147483500;100;40;5;1;1
100
1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1;1
30;10;10
NO
98;2;1
30;11;9
100;100;20;20;4;4;2
NO
NO
NO
NO
